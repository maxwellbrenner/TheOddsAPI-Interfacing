# Preprocessing Masterlist for Odds Integration

This script is designed to standardize fighter names in a UFC event dataset -- `cleaned_event_masterlist.csv` generated by `UFCStats Scraper` -- and filter the data to retain only essential columns to support subsequent odds integration.

---

## Overview of the `main()` Function

The `main()` function orchestrates the data processing steps, including loading the UFC dataset, updating fighter names, filtering relevant columns, and saving the preprocessed data to a CSV file. 

Below is a breakdown of each step:

1. **Load Dataset**: Loads `cleaned_event_masterlist.csv` containing UFC event data.

2. **Replace Fighter Names and Update Winner**: Calls `replace_fighter_name_and_update_winner()` to standardize fighter names according to a predefined dictionary. If a fighter’s name is updated, the winner field is also updated if it matches the old name.

3. **Filter Columns**: Calls `drop_columns()` to retain only essential columns, ensuring the dataset is ready for further analysis.

4. **Save Cleaned Data**: Exports the cleaned and filtered dataset to a new CSV file -> `preprocessed_event_masterlist.csv`

---

## Function Descriptions -- Ordered by Execution in `main()`

### 1. `replace_fighter_name_and_update_winner(row)`
- **Description**: This function standardizes fighter names based on a dictionary of name replacements. If a fighter’s name is changed, the function updates the `winner` column if it matches the old name.
- **Returns**: The modified row with updated fighter names and `winner` field, if applicable.

### 2. `drop_columns(df)`
- **Description**: Filters the DataFrame to keep only the specified columns, dropping any others. This step ensures the dataset is streamlined for analysis by retaining only relevant information.
- **Returns**: A filtered DataFrame with only the essential columns.

---

## Execution Flow

### 1. Loading the Dataset

The program loads a CSV file containing UFC event data, including columns for event details, fighter names, and match outcomes. The file path is specified in the `main()` function.

### 2. Standardizing Fighter Names and Updating Winner Field

The `replace_fighter_name_and_update_winner()` function checks each row in the dataset to see if a fighter’s name needs to be replaced based on a predefined dictionary (`name_replacements`). 
If an old name is found:
- The function updates `fighter_a_name` or `fighter_b_name` to the new name.
- If the `winner` field matches the old fighter name, it is updated to reflect the new name, ensuring consistency.

- **Input**: Each row of the DataFrame, containing `fighter_a_name`, `fighter_b_name`, and `winner`.
- **Output**: The row with standardized fighter names and updated winner (if necessary).

#### Example of Name Replacement
If a row contains:
- **fighter_a_name**: "Maheshate"
- **fighter_b_name**: "John Doe"
- **winner**: "Maheshate"

And `name_replacements` specifies that "Maheshate" should be replaced with "Hayisaer Maheshate," the function will:
1. Update `fighter_a_name` to `"Hayisaer Maheshate"`.
2. Change `winner` to `"Hayisaer Maheshate"`.

### 3. Dropping Unnecessary Columns

The `drop_columns()` function filters the dataset to keep only essential columns for analysis, including event details, fighter names, fight outcomes, and specific statistics.

- **Input**: The full DataFrame.
- **Output**: A filtered DataFrame with only the specified columns.

#### Retained Columns
- **Event Details**: `event_name`, `event_date`, `event_location`
- **Fight Details**: `fighter_a_name`, `fighter_b_name`, `winner`, `method_of_victory`, `round_of_victory`, `time_of_victory`, `time_format`, `referee`, `weightclass`, `title_fight`, `gender`

### 4. Saving Cleaned Data to CSV

After standardizing names and filtering columns, the program saves the cleaned dataset to `preprocessed_event_masterlist.csv`

The file path for saving is specified in `main()`.

## Example CSV Output

The file contains columns as outlined in the following structure:

#### Event and Fight Information
- **event_name**: The name of the UFC event.
- **event_date**: The date of the event.
- **event_location**: The location where the event took place.

#### Fighter and Match Outcome
- **fighter_a_name**: The name of the first fighter.
- **fighter_b_name**: The name of the second fighter.
- **winner**: The name of the fight’s winner (updated if necessary during the name replacement process).
- **method_of_victory**: The method by which the fight was won (e.g., "KO/TKO").
- **round_of_victory**: The round in which the fight ended.
- **time_of_victory**: The time remaining when the fight ended.
- **time_format**: The format of the rounds (e.g., "5 Rnd (5-5-5-5-5)").
- **referee**: The name of the referee officiating the fight.
- **weightclass**: The weight class of the fight (e.g., "Lightweight").
- **title_fight**: A boolean indicating if the fight is a title match.
- **gender**: The gender category of the fighters (e.g., "Men" or "Women").

We are now ready to integrate closing odds.
